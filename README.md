# CSmart νΈμ… μƒλ‹΄ AI μ‹μ¤ν…

λ€ν•™ νΈμ… μ¤€λΉ„μƒμ„ μ„ν• μ§€λ¥ν• μƒλ‹΄ μ‹μ¤ν…μ…λ‹λ‹¤. **νμΈνλ‹ λ¨λΈ**κ³Ό **LangGraph μ—μ΄μ „νΈ**λ¥Ό ν†µν•©ν• ν•μ΄λΈλ¦¬λ“ AI μ‹μ¤ν…μ…λ‹λ‹¤.

## π†• ν•µμ‹¬ κΈ°λ¥: ν†µν•© AI μ‹μ¤ν…

**ν•λ‚μ API**λ΅ λ‘ κ°€μ§€ AI λ¨λΈμ„ ν•¨κ» μ‚¬μ©ν•©λ‹λ‹¤:

### π― μλ™ λΌμ°ν… (Question Routing)
μ§λ¬Έμ λ³µμ΅λ„μ— λ”°λΌ **μλ™μΌλ΅** μ μ ν• λ¨λΈμ„ μ„ νƒν•©λ‹λ‹¤:

- **κ°„λ‹¨ν• μ§λ¬Έ** (μΌλ°μ μΈ ν•™μµ μ΅°μ–Έ) β†’ π“ **νμΈνλ‹ λ¨λΈ** μ‚¬μ©
  - μ›μ‹ λ‹µλ³€ μƒμ„± β†’ **LLM μ¬κ°€κ³µ** β†’ ν’μ§ ν‰κ°€ β†’ μµμΆ… λ‹µλ³€
  - λΉ λ¥΄κ³  ν¨μ¨μ , μΌλ°μ μΈ ν•™μµ μ΅°μ–Έμ— μµμ ν™”
- **λ³µμ΅ν• μ§λ¬Έ** (νΉμ • λ€ν•™/μΌμ •/μ „ν• μ •λ³΄) β†’ π¤– **LangGraph μ—μ΄μ „νΈ** μ‚¬μ©
  - GuidelineDB κ²€μƒ‰ + μ›Ή κ²€μƒ‰ β†’ μΆ…ν•© λ¶„μ„ β†’ μƒμ„Έν• λ‹µλ³€
  - μ •ν™•ν•κ³  μƒμ„Έ, κ²€μƒ‰ κΈ°λ° μ •λ³΄ μ κ³µ

### π”„ ν’μ§ λ³΄μ¥ μ‹μ¤ν…
- **νμΈνλ‹ λ¨λΈ**: λ‹µλ³€ ν’μ§ ν‰κ°€ ν›„ 6μ  λ―Έλ§ μ‹ LangGraphλ΅ μλ™ μ¬λΌμ°ν…
- **μ¤λ¥ μ²λ¦¬**: νμΈνλ‹ λ¨λΈ μ¤λ¥ μ‹ LangGraphλ΅ μλ™ ν΄λ°±
- **μ΄μ¤‘ μ•μ „μ¥μΉ**: μ–΄λ–¤ μƒν™©μ—μ„λ„ μµμ μ λ‹µλ³€ λ³΄μ¥

**μμ‹:**
- β… "μν•™ κ³µλ¶€λ” μ–΄λ–»κ² ν•΄μ•Ό ν• κΉμ”?" β†’ νμΈνλ‹ λ¨λΈ (μ¬κ°€κ³µ ν›„ λ°ν™)
- β… "μ¤‘μ•™λ€ν•™κµ μ΄κ³Ό νΈμ…μ€ μ–΄λ–¤ κ³Όλ©μ„ μ¤€λΉ„ν•΄μ•Ό ν•λ‚μ”?" β†’ LangGraph μ—μ΄μ „νΈ
- β… νμΈνλ‹ λ‹µλ³€ ν’μ§ λ―Έλ‹¬ β†’ μλ™μΌλ΅ LangGraphλ΅ μ¬μ‹λ„

## β΅ λΉ λ¥Έ μ‹μ‘ (μ²μ μ‚¬μ©μ)

```bash
# 1. ν¨ν‚¤μ§€ μ„¤μΉ
pip install -r requirements.txt

# 2. .env νμΌμ— API ν‚¤ μ„¤μ • (GOOGLE_API_KEY, TAVILY_API_KEY)

# 3. my_question.py νμΌ μ—΄μ–΄μ„ μ§λ¬Έ μμ • ν›„ μ‹¤ν–‰
python my_question.py
```

**λ!**


---

## π—οΈ ν”„λ΅μ νΈ κµ¬μ΅°

```
CSmart/
β”β”€β”€ π““ CSmart_LangGraph.ipynb       # μ›λ³Έ Jupyter Notebook (ipynb)
β”β”€β”€ π― api.py                       # π†• ν†µν•© API (νμΈνλ‹ + LangGraph)
β”β”€β”€ β­ my_question.py               # μ§λ¬Έ μ…λ ¥μ© (κ°€μ¥ κ°„λ‹¨!)
β”β”€β”€ π“ example_usage.py             # μ‚¬μ© μμ  λ¨μ
β”‚
β”β”€β”€ step1_env.py                    # ν™κ²½ λ³€μ λ΅λ“ (Cell 2)
β”β”€β”€ step2_states.py                 # μƒνƒ μ •μ λ° prepare_context (Cell 4-5)
β”β”€β”€ step3_db_and_search.py          # DB λ° κ²€μƒ‰ λ„κµ¬ (Cell 9, ν•μ΄λΈλ¦¬λ“ κ²€μƒ‰)
β”β”€β”€ step4_llm.py                    # LLM μ„¤μ • (Cell 14, Gemini)
β”β”€β”€ step5_guideline_agent.py        # GuidelineDB RAG μ—μ΄μ „νΈ (Cell 19)
β”β”€β”€ step6_web_agent.py              # μ›Ή κ²€μƒ‰ RAG μ—μ΄μ „νΈ (Cell 22)
β”β”€β”€ step7_integrated_agent.py       # ν†µν•© μ—μ΄μ „νΈ (Cell 25-27, λΌμ°ν…)
β”β”€β”€ step8_test.py                   # π†• ν†µν•© API ν…μ¤νΈ (κΉ”λ”ν• λ΅κ·Έ)
β”β”€β”€ test_routing.py                 # λΌμ°ν… κΈ°λ¥ ν…μ¤νΈ μ¤ν¬λ¦½νΈ
β”‚
β”β”€β”€ GuidelineDB.csv                 # κ°€μ΄λ“λΌμΈ λ°μ΄ν„°
β”β”€β”€ chroma_guideline/               # λ²΅ν„° DB μ €μ¥μ†
β”β”€β”€ requirements.txt                # ν•„μ” ν¨ν‚¤μ§€
β”β”€β”€ .env                            # ν™κ²½ λ³€μ
β”β”€β”€ system_architecture.md          # π†• μ‹μ¤ν… μ•„ν‚¤ν…μ² λ¬Έμ„
β”β”€β”€ generate_diagrams.html          # π†• λ‹¤μ΄μ–΄κ·Έλ¨ μ‹κ°ν™”
β””β”€β”€ README.md                       # μ΄ νμΌ
```



## π’΅ μ¤‘μ”: ipynb vs api.py

μ΄ ν”„λ΅μ νΈλ” **λ‘ κ°€μ§€ λ°©μ‹**μΌλ΅ μ‚¬μ©κ°€λ¥:

1. **`CSmart_LangGraph.ipynb`** (Jupyter Notebook)
   - μ›λ³Έ κ°λ° νμΌ
   - κ° μ…€μ„ λ‹¨κ³„λ³„λ΅ μ‹¤ν–‰ν•λ©° ν™•μΈ κ°€λ¥

2. **`api.py`** (Python μ¤ν¬λ¦½νΈ)
   - ipynbλ¥Ό λ¨λ“ν™”ν• λ²„μ „
   

**β οΈ λ‘ νμΌμ€ 100% λ™μΌν• λ΅μ§μ„ μ‚¬μ©ν•©λ‹λ‹¤!**
- ipynbμ λ¨λ“  μ½”λ“κ°€ step1-8.pyλ΅ λ¶„λ¦¬λ¨
- api.pyλ” μ΄λ¥Ό ν•λ‚λ΅ ν†µν•©ν• μΈν„°νμ΄μ¤
- **μ•„λ¬΄κ±°λ‚ μ‚¬μ©ν•΄λ„ κ²°κ³Όλ” κ°™μµλ‹λ‹¤**

---

## π€ λΉ λ¥Έ μ‹μ‘

### 1. ν¨ν‚¤μ§€ μ„¤μΉ
```bash
pip install -r requirements.txt
```

### 2. ν™κ²½ λ³€μ μ„¤μ •
`.env` νμΌμ„ μƒμ„±ν•κ³  λ‹¤μ λ‚΄μ©μ„ μ¶”κ°€:
```
GOOGLE_API_KEY=your_google_api_key_here
TAVILY_API_KEY=your_tavily_api_key_here
```

### 3. μ§λ¬Έν•λ” λ°©λ²•

#### π― λ°©λ²• 1: κ°„λ‹¨ν•κ² μ§λ¬Έ λ°”κΎΈκΈ° (κ°€μ¥ μ¶”μ²!)

**Step 1)** `my_question.py` νμΌ μ—΄κΈ°

**Step 2)** μ§λ¬Έ λ‚΄μ©λ§ μμ •:
```python
question = "μ—¬κΈ°μ— μ›ν•λ” μ§λ¬Έ μ…λ ¥!"  # π‘ μ΄ λ¶€λ¶„λ§ μμ •
```

**Step 3)** ν„°λ―Έλ„μ—μ„ μ‹¤ν–‰:
```bash
python my_question.py
```

**μ¥μ :**
- β… μ§λ¬Έλ§ λ°”κΎΈλ©΄ λ¨ (κ°€μ¥ κ°„λ‹¨)
- β… μ›λ³Έ νμΌ(api.py) μ•μ „
- β… μ—¬λ¬ μ§λ¬Έ νμΌμ„ λ§λ“¤ μ μμ

---

#### π“ λ°©λ²• 2: μ§μ ‘ μ½”λ“ μ‘μ„±

μƒλ΅μ΄ `.py` νμΌμ„ λ§λ“¤μ–΄μ„ μ‚¬μ©:

```python
from api import get_answer

# π†• κ°„λ‹¨ν• μ§λ¬Έ (μλ™μΌλ΅ νμΈνλ‹ λ¨λΈ μ‚¬μ©)
result = get_answer("μν•™ κ³µλ¶€λ” μ–΄λ–»κ² ν•΄μ•Ό ν• κΉμ”?")
print(f"μ‚¬μ©λ λ¨λΈ: {result['model_used']}")  # "finetuned_refined"
print(result["final_answer"])

# π†• λ³µμ΅ν• μ§λ¬Έ (μλ™μΌλ΅ LangGraph μ‚¬μ©)
result = get_answer("μ¤‘μ•™λ€ν•™κµ μ΄κ³Ό νΈμ…μ€ μ–΄λ–¤ κ³Όλ©μ„ μ¤€λΉ„ν•΄μ•Ό ν•λ‚μ”?")
print(f"μ‚¬μ©λ λ¨λΈ: {result['model_used']}")  # "langgraph"
print(result["final_answer"])

# λ΅κ·Έ μ¨κΈ°κΈ° (κΉ”λ”ν• μ¶λ ¥)
result = get_answer("μ§λ¬Έλ‚΄μ©", verbose=False)
print(result["final_answer"])

# π†• κ°•μ  λ¨λ“ (νΉμ • λ¨λΈ μ§€μ •)
result = get_answer("μν•™ κ³µλ¶€λ²•", force_mode="complex")  # LangGraph κ°•μ  μ‚¬μ©
result = get_answer("μ¤‘μ•™λ€ νΈμ…", force_mode="simple")   # νμΈνλ‹ κ°•μ  μ‚¬μ©
```

**Parameters:**
- `question` (str): ν•™μƒμ μ§λ¬Έ
- `student_profile` (dict, optional): ν•™μƒ ν”„λ΅ν•„
  - `target_university`: λ©ν‘ λ€ν•™λ…
  - `track`: κ³„μ—΄ (μ΄κ³Ό/λ¬Έκ³Ό)
- `recent_dialogues` (list, optional): μµκ·Ό λ€ν™” λ‚΄μ—­
  - κ° ν•­λ©: `{"role": "student"|"teacher", "message": "..."}`
- `verbose` (bool, optional): λ΅κ·Έ μ¶λ ¥ μ—¬λ¶€ (κΈ°λ³Έκ°’: True)
- `force_mode` (Literal["simple", "complex"], optional): π†• λ¨λΈ κ°•μ  μ§€μ •
  - `"simple"`: νμΈνλ‹ λ¨λΈ κ°•μ  μ‚¬μ©
  - `"complex"`: LangGraph μ—μ΄μ „νΈ κ°•μ  μ‚¬μ©
  - `None`: μλ™ νλ³„ (κΈ°λ³Έκ°’)

**Returns:**
```python
{
    "question": "μ›λ³Έ μ§λ¬Έ",
    "final_answer": "μµμΆ… λ‹µλ³€",
    "model_used": "finetuned_refined" λλ” "langgraph" λλ” "langgraph_fallback",  # π†• μ‚¬μ©λ λ¨λΈ
    "context": "μƒμ„±λ μ»¨ν…μ¤νΈ",
    "datasources": ["μ‚¬μ©λ", "λ°μ΄ν„°", "μ†μ¤"],
    "success": True,
    "error": None
}
```

---



## π”„ μ‹¤μ  λ™μ‘ κ³Όμ •

`python api.py` μ‹¤ν–‰ μ‹:

```
1. π€ API μ΄κΈ°ν™”
   β””β”€ step1~7 λ¨λ“  λ¨λ“ μλ™ λ΅λ“
   β””β”€ Chroma DB, LLM, μ—μ΄μ „νΈ μλ™ μ»΄νμΌ

π†• 2. π”€ μ§λ¬Έ λ³µμ΅λ„ νλ³„ (μλ™ λΌμ°ν…)
   β”β”€ LLMμ΄ μ§λ¬Έ λ¶„μ„
   β”β”€ κ°„λ‹¨ν• μ§λ¬Έ? β†’ π“ νμΈνλ‹ λ¨λΈ μ‚¬μ©
   β”‚   β”β”€ Hugging Face API νΈμ¶ β†’ μ›μ‹ λ‹µλ³€ μƒμ„±
   β”‚   β”β”€ LLMμΌλ΅ λ‹µλ³€ μ¬κ°€κ³µ β†’ μ™„μ„±λ„ ν–¥μƒ
   β”‚   β”β”€ λ‹µλ³€ ν’μ§ ν‰κ°€ (1-10μ )
   β”‚   β”β”€ 6μ  μ΄μƒ? β†’ μ¬κ°€κ³µλ λ‹µλ³€ λ°ν™
   β”‚   β””β”€ 6μ  λ―Έλ§? β†’ LangGraphλ΅ μ¬λΌμ°ν…
   β””β”€ λ³µμ΅ν• μ§λ¬Έ? β†’ π¤– LangGraph μ—μ΄μ „νΈ μ‚¬μ© (μ•„λ 3-6λ‹¨κ³„)

3. π“‹ μ»¨ν…μ¤νΈ μ¤€λΉ„ (step2, LangGraph μ‚¬μ© μ‹)
   β””β”€ ν•™μƒ ν”„λ΅ν•„ + λ€ν™” λ‚΄μ—­ β†’ context μƒμ„±

4. π” μ§λ¬Έ λ¶„μ„ (step7, LangGraph μ‚¬μ© μ‹)
   β””β”€ LLMμ΄ μ μ ν• λ„κµ¬ μ„ νƒ (GuidelineDB / Web)
   
5. π“ GuidelineDB κ²€μƒ‰ (step5, μ„ νƒ μ‹)
   β”β”€ [1λ‹¨κ³„] ν•μ΄λΈλ¦¬λ“ κ²€μƒ‰μΌλ΅ λ¬Έμ„ κ²€μƒ‰
   β”β”€ [2λ‹¨κ³„] LLMμ΄ μ •λ³΄ μ¶”μ¶ λ° ν‰κ°€
   β”β”€ [νλ‹¨] μ •λ³΄ μ¶©λ¶„ μ—¬λ¶€ ν™•μΈ
   β”β”€ [3λ‹¨κ³„] λ¶€μ΅± μ‹ μΏΌλ¦¬ μ¬μ‘μ„± (μµλ€ 2ν)
   β””β”€ [4λ‹¨κ³„] μµμΆ… λ‹µλ³€ μƒμ„±

6. π μ›Ή κ²€μƒ‰ (step6, μ„ νƒ μ‹)
   β”β”€ Tavily APIλ΅ λ¬Έμ„ κ²€μƒ‰
   β”β”€ μ •λ³΄ μ¶”μ¶ λ° ν‰κ°€
   β”β”€ λ¶€μ΅± μ‹ μΏΌλ¦¬ μ¬μ‘μ„±
   β””β”€ μµμΆ… λ‹µλ³€ μƒμ„±

7. π“ μµμΆ… λ‹µλ³€ μƒμ„± (step7, LangGraph μ‚¬μ© μ‹)
   β””β”€ μμ§‘λ μ •λ³΄λ¥Ό μΆ…ν•©ν•μ—¬ ν•™μƒμ—κ² μ κ³µ
```

### μ „μ²΄ μ‹μ¤ν… κµ¬μ΅°
<img width="740" height="2124" alt="1  μ „μ²΄ μ‹μ¤ν… κµ¬μ΅°" src="https://github.com/user-attachments/assets/54877d23-ad6c-4d64-8bdc-e21ca6d4554b" />

---

## π§ ν…μ¤νΈ

### ν†µν•© API ν…μ¤νΈ (μ¶”μ²!)
```bash
python step8_test.py
```

κΉ”λ”ν• λ΅κ·Έμ™€ ν•¨κ» ν†µν•© APIλ¥Ό ν…μ¤νΈν•©λ‹λ‹¤:
- κ°„λ‹¨ν• μ§λ¬Έ (νμΈνλ‹ λ¨λΈ)
- λ³µμ΅ν• μ§λ¬Έ (LangGraph μ—μ΄μ „νΈ)
- μλ™ λ¨λ“ ν…μ¤νΈ
- μ²λ¦¬ μ‹κ°„ λ° μ‚¬μ©λ λ¨λΈ ν‘μ‹

### λΌμ°ν… κΈ°λ¥ ν…μ¤νΈ
```bash
python test_routing.py
```

λ‹¤μ–‘ν• μ§λ¬ΈμΌλ΅ μλ™ λΌμ°ν… κΈ°λ¥μ„ ν…μ¤νΈν•©λ‹λ‹¤:
- κ°„λ‹¨ν• μ§λ¬Έ (νμΈνλ‹ λ¨λΈ)
- λ³µμ΅ν• μ§λ¬Έ (LangGraph)
- κ°•μ  λ¨λ“ ν…μ¤νΈ
- λ‹¤μ–‘ν• μ§λ¬Έ μ ν• ν…μ¤νΈ

### μ‹μ¤ν… μ•„ν‚¤ν…μ² μ‹κ°ν™”
```bash
# λΈλΌμ°μ €μ—μ„ λ‹¤μ΄μ–΄κ·Έλ¨ ν™•μΈ
start generate_diagrams.html
```

μ‹μ¤ν… κµ¬μ΅°μ™€ λ°μ΄ν„° νλ¦„μ„ μ‹κ°μ μΌλ΅ ν™•μΈν•  μ μμµλ‹λ‹¤.

---

## π“ νμΈνλ‹ λ¨λΈ API μ •λ³΄

**API μ—”λ“ν¬μΈνΈ:** `https://csmart-ai-faq-finetuning.hf.space/predict`

**μ‚¬μ©λ λ¨λΈ:** Gemma 2B (νμΈνλ‹)

**νΉμ§•:**
- β΅ λΉ λ¥Έ μ‘λ‹µ μ†λ„
- π’΅ μΌλ°μ μΈ ν•™μµ μ΅°μ–Έμ— μµμ ν™”
- π”„ μλ™ μ¬μ‹λ„ (μµλ€ 3ν)
- β±οΈ νƒ€μ„μ•„μ›ƒ 120μ΄
- π― LLM μ¬κ°€κ³µμΌλ΅ λ‹µλ³€ ν’μ§ ν–¥μƒ
- π“ ν’μ§ ν‰κ°€ ν›„ ν•„μ”μ‹ LangGraphλ΅ μλ™ μ¬λΌμ°ν…

---

## π“ μ‹μ¤ν… μ•„ν‚¤ν…μ²

μμ„Έν• μ‹μ¤ν… κµ¬μ΅°μ™€ λ°μ΄ν„° νλ¦„μ€ λ‹¤μ νμΌλ“¤μ„ μ°Έκ³ ν•μ„Έμ”:

- π“„ `system_architecture.md`: μƒμ„Έν• μ•„ν‚¤ν…μ² λ¬Έμ„
- π¨ `generate_diagrams.html`: μ‹κ°μ  λ‹¤μ΄μ–΄κ·Έλ¨ (λΈλΌμ°μ €μ—μ„ ν™•μΈ)

### ν•µμ‹¬ μ»΄ν¬λ„νΈ
1. **μ§λ¬Έ λ³µμ΅λ„ νλ³„κΈ°**: LLM κΈ°λ° μλ™ λ¶„λ¥
2. **νμΈνλ‹ λ¨λΈ**: λΉ λ¥Έ μΌλ° μ§λ¬Έ μ²λ¦¬
3. **λ‹µλ³€ μ¬κ°€κ³µκΈ°**: LLM κΈ°λ° λ‹µλ³€ ν’μ§ ν–¥μƒ
4. **ν’μ§ ν‰κ°€κΈ°**: λ‹µλ³€ ν’μ§ μλ™ ν‰κ°€
5. **LangGraph μ—μ΄μ „νΈ**: λ³µμ΅ν• μ§λ¬Έ μ²λ¦¬
6. **ν•μ΄λΈλ¦¬λ“ κ²€μƒ‰**: GuidelineDB + μ›Ή κ²€μƒ‰


